<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Đăng ký làm Hướng dẫn viên</title>
	<link rel="stylesheet" href="styles.css">
	<script src="script.js"></script>
	<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

	<style>
		.login-container .login-form-container {
			display: flex;
			gap: 10px;
			padding: 80px;
		}
		
		.login-form {
			height: 360px;
		}

		.login-form input {
			width: 500px;
		}

		.login-form label {
			width: 500px;
		}

		/* Container styling */
		.dropdown {
			position: relative;
			display: inline-block;
			width: 522px;
		}

		/* Input field */


		/* Dropdown menu */
		.dropdown-menu {
			position: absolute;
			width: 100%;
			background: white;
			border: 1px solid #ccc;
			max-height: 200px;
			overflow-y: auto;
			display: none;
			z-index: 10;
			box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.2);
		}

		/* Show dropdown */
		.dropdown.active .dropdown-menu {
			display: block;
		}

		/* Searchable checkboxes */
		.dropdown-menu label {
			display: block;
			padding: 5px;
			cursor: pointer;
		}

		.dropdown-menu label:hover {
			background: #f1f1f1;
		}

		#experience {
			border-radius: 25px;
			width: 500px;
			padding: 10px;
			border: 1px solid #ccc;
		}

		.dropdown-menu input {
			width: 15px;
		}
	</style>



</head>

<body>

	<!-- Navigation Bar -->
	<div th:replace="~{components :: header}"></div>

	<div class="login-container">
		<h3>Trở thành hướng dẫn viên</h3>
		<form>
			<div class="login-form-container">
				<div class="login-form">
					<label for="email">Email</label>
					<input type="email" id="email" placeholder="Email" required>

					<label for="password" th:text="#{password}"></label>
					<input type="password" id="password" th:attr="placeholder=#{password}" required>

					<label for="repassword" th:text="#{repassword}"></label>
					<input type="password" id="repassword" th:attr="placeholder=#{repassword}" required>

					<div class="policy">
						<p id="8characterCondition">
							<span class="error-icon"> • </span>
							<svg class="success-icon" width="16" height="16" viewBox="0 0 16 16" fill="green"
								style="display: none;">
								<path fill="green"
									d="M6.173 13.927L1.22 9.08l1.56-1.44 3.393 3.179 7.073-7.073 1.56 1.56z" />
							</svg>
							<span th:text="#{8characterCondition}"></span>
						</p>
						<p id="uppercaseCondition">
							<span class="error-icon"> • </span>
							<svg class="success-icon" width="16" height="16" viewBox="0 0 16 16" fill="green"
								style="display: none;">
								<path fill="green"
									d="M6.173 13.927L1.22 9.08l1.56-1.44 3.393 3.179 7.073-7.073 1.56 1.56z" />
							</svg>
							<span th:text="#{uppercaseCondition}"></span>
						</p>
						<p id="specialCondition">
							<span class="error-icon"> • </span>
							<svg class="success-icon" width="16" height="16" viewBox="0 0 16 16" fill="green"
								style="display: none;">
								<path fill="green"
									d="M6.173 13.927L1.22 9.08l1.56-1.44 3.393 3.179 7.073-7.073 1.56 1.56z" />
							</svg>
							<span th:text="#{specialCondition}"></span>
						</p>
						<p id="passwordCondition">
							<span class="error-icon"> • </span>
							<svg class="success-icon" width="16" height="16" viewBox="0 0 16 16" fill="green"
								style="display: none;">
								<path fill="green"
									d="M6.173 13.927L1.22 9.08l1.56-1.44 3.393 3.179 7.073-7.073 1.56 1.56z" />
							</svg>
							<span th:text="#{passwordCondition}"></span>
						</p>
						<label>
							<input id="myCheckBox" type="checkbox" name="partnerType" th:text="#{policyCondition}">
						</label>
					</div>
				</div>
				<div class="login-form">
					<label for="name" th:text="name">Họ tên:</label>
					<input id="name" th:attr="placeholder=#{name}" required >


					<label for="city">Chọn tỉnh/thành phố:</label>
					<div class="dropdown">
						<input type="text" id="cities" placeholder="Tìm kiếm...">
						<div class="dropdown-menu" id="cityMenu">
							<label><input type="checkbox" value="An Giang"> An Giang</label>
							<label><input type="checkbox" value="Bà Rịa - Vũng Tàu"> Bà Rịa - Vũng Tàu</label>
							<label><input type="checkbox" value="Bắc Giang"> Bắc Giang</label>
							<label><input type="checkbox" value="Bắc Kạn"> Bắc Kạn</label>
							<label><input type="checkbox" value="Bạc Liêu"> Bạc Liêu</label>
							<label><input type="checkbox" value="Bắc Ninh"> Bắc Ninh</label>
							<label><input type="checkbox" value="Bến Tre"> Bến Tre</label>
							<label><input type="checkbox" value="Bình Định"> Bình Định</label>
							<label><input type="checkbox" value="Bình Dương"> Bình Dương</label>
							<label><input type="checkbox" value="Bình Phước"> Bình Phước</label>
							<label><input type="checkbox" value="Bình Thuận"> Bình Thuận</label>
							<label><input type="checkbox" value="Cà Mau"> Cà Mau</label>
							<label><input type="checkbox" value="Cần Thơ"> Cần Thơ</label>
							<label><input type="checkbox" value="Cao Bằng"> Cao Bằng</label>
							<label><input type="checkbox" value="Đà Nẵng"> Đà Nẵng</label>
							<label><input type="checkbox" value="Đắk Lắk"> Đắk Lắk</label>
							<label><input type="checkbox" value="Đắk Nông"> Đắk Nông</label>
							<label><input type="checkbox" value="Điện Biên"> Điện Biên</label>
							<label><input type="checkbox" value="Đồng Nai"> Đồng Nai</label>
							<label><input type="checkbox" value="Đồng Tháp"> Đồng Tháp</label>
							<label><input type="checkbox" value="Gia Lai"> Gia Lai</label>
							<label><input type="checkbox" value="Hà Giang"> Hà Giang</label>
							<label><input type="checkbox" value="Hà Nam"> Hà Nam</label>
							<label><input type="checkbox" value="Hà Nội"> Hà Nội</label>
							<label><input type="checkbox" value="Hà Tĩnh"> Hà Tĩnh</label>
							<label><input type="checkbox" value="Hải Dương"> Hải Dương</label>
							<label><input type="checkbox" value="Hải Phòng"> Hải Phòng</label>
							<label><input type="checkbox" value="Hậu Giang"> Hậu Giang</label>
							<label><input type="checkbox" value="Hòa Bình"> Hòa Bình</label>
							<label><input type="checkbox" value="Hưng Yên"> Hưng Yên</label>
							<label><input type="checkbox" value="Khánh Hòa"> Khánh Hòa</label>
							<label><input type="checkbox" value="Kiên Giang"> Kiên Giang</label>
							<label><input type="checkbox" value="Kon Tum"> Kon Tum</label>
							<label><input type="checkbox" value="Lai Châu"> Lai Châu</label>
							<label><input type="checkbox" value="Lâm Đồng"> Lâm Đồng</label>
							<label><input type="checkbox" value="Lạng Sơn"> Lạng Sơn</label>
							<label><input type="checkbox" value="Lào Cai"> Lào Cai</label>
							<label><input type="checkbox" value="Long An"> Long An</label>
							<label><input type="checkbox" value="Nam Định"> Nam Định</label>
							<label><input type="checkbox" value="Nghệ An"> Nghệ An</label>
							<label><input type="checkbox" value="Ninh Bình"> Ninh Bình</label>
							<label><input type="checkbox" value="Ninh Thuận"> Ninh Thuận</label>
							<label><input type="checkbox" value="Phú Thọ"> Phú Thọ</label>
							<label><input type="checkbox" value="Phú Yên"> Phú Yên</label>
							<label><input type="checkbox" value="Quảng Bình"> Quảng Bình</label>
							<label><input type="checkbox" value="Quảng Nam"> Quảng Nam</label>
							<label><input type="checkbox" value="Quảng Ngãi"> Quảng Ngãi</label>
							<label><input type="checkbox" value="Quảng Ninh"> Quảng Ninh</label>
							<label><input type="checkbox" value="Quảng Trị"> Quảng Trị</label>
							<label><input type="checkbox" value="Sóc Trăng"> Sóc Trăng</label>
							<label><input type="checkbox" value="Sơn La"> Sơn La</label>
							<label><input type="checkbox" value="Tây Ninh"> Tây Ninh</label>
							<label><input type="checkbox" value="Thái Bình"> Thái Bình</label>
							<label><input type="checkbox" value="Thái Nguyên"> Thái Nguyên</label>
							<label><input type="checkbox" value="Thanh Hóa"> Thanh Hóa</label>
							<label><input type="checkbox" value="Thừa Thiên Huế"> Thừa Thiên Huế</label>
							<label><input type="checkbox" value="Tiền Giang"> Tiền Giang</label>
							<label><input type="checkbox" value="TP. Hồ Chí Minh"> TP. Hồ Chí Minh</label>
							<label><input type="checkbox" value="Trà Vinh"> Trà Vinh</label>
							<label><input type="checkbox" value="Tuyên Quang"> Tuyên Quang</label>
							<label><input type="checkbox" value="Vĩnh Long"> Vĩnh Long</label>
							<label><input type="checkbox" value="Vĩnh Phúc"> Vĩnh Phúc</label>
							<label><input type="checkbox" value="Yên Bái"> Yên Bái</label>
						</div>

					</div>

					<script>
						const input = document.getElementById("cities");
						const dropdown = document.querySelector(".dropdown");
						const menu = document.getElementById("cityMenu");

						// Show dropdown when clicking input
						input.addEventListener("focus", () => {
							dropdown.classList.add("active");
						});

						// Hide dropdown when clicking outside
						document.addEventListener("click", (e) => {
							if (!dropdown.contains(e.target)) {
								dropdown.classList.remove("active");
							}
						});

						// Search functionality
						input.addEventListener("input", () => {
							let filter = input.value.toLowerCase();
							let items = menu.getElementsByTagName("label");
							for (let item of items) {
								let text = item.textContent.toLowerCase();
								item.style.display = text.includes(filter) ? "block" : "none";
							}
						});

						// Update input with selected values
						menu.addEventListener("change", () => {
							let selectedValues = Array.from(menu.querySelectorAll("input:checked")).map(el => el.value);
							input.value = selectedValues.join(", ");
						});
					</script>



					<label for="years-of-experience">Số năm kinh nghiệm:</label>
					<input required>
					<label for="experience">Thông tin chi tiết về kinh nghiệp hướng dẫn của bạn:</label>
					<textarea id="experience" name="experience" rows="4" cols="50" required></textarea>
				</div>
			</div>

			<button id="signup" type="submit" class="login-btn" disabled>Đăng ký</button>
		</form>
	</div>
	<div th:replace="~{components :: footer}"></div>


	<script>
		function checkInputs() {
			var email = $('#email').val();
			var password = $('#password').val();
			var repassword = $('#repassword').val();
			var acceptPolicy = $('#myCheckBox').prop('checked');
			var button = $('#signup');

			if (email && password && repassword && acceptPolicy && password === repassword) {
				button.prop('disabled', false); // Enable the button
			} else {
				button.prop('disabled', true); // Disable the button
			}
		}

		$(document).ready(function () {
			function validatePassword() {
				var password = $('#password').val();
				var repassword = $('#repassword').val();

				// Kiểm tra điều kiện
				var isLongEnough = password.length >= 8;
				var hasUpperCase = /[A-Z]/.test(password);
				var hasSpecialChar = /[!@#$%^&*]/.test(password);
				var isMatching = password === repassword && password.length > 0;

				function toggleValidation(condition, selector) {
					if (condition) {
						$(selector).find('.error-icon').hide();
						$(selector).find('.success-icon').show();
						$(selector).css('color', 'green');
					} else {
						$(selector).find('.error-icon').show();
						$(selector).find('.success-icon').hide();
						$(selector).css('color', 'red');
					}
				}

				toggleValidation(isLongEnough, '#8characterCondition');
				toggleValidation(hasUpperCase, '#uppercaseCondition');
				toggleValidation(hasSpecialChar, '#specialCondition');
				toggleValidation(isMatching, '#passwordCondition');
			}

			// Gọi validatePassword khi người dùng nhập vào ô password hoặc repassword
			$('#password, #repassword').on('input', validatePassword);
		});

		// Add event listeners to inputs using jQuery
		$('#email, #password, #repassword').on('input', checkInputs);
		$('#myCheckBox').on('change', checkInputs);


		// Handle form submission with AJAX using jQuery
		$('#signupForm').on('submit', function (e) {
			e.preventDefault(); // Prevent default form submission

			var email = $('#email').val();
			var password = $('#password').val();

			var touristData = {
				email: email,
				password: password
			};

			// Sending data to API using jQuery AJAX
			$.ajax({
				url: '/api/auth/signup/tourist',
				type: 'POST',
				contentType: 'application/json',
				data: JSON.stringify(touristData),
				success: function (response) {
					alert('Registration successful!');
					window.location.href = '/';
				},
				error: function (xhr, status, error) {
					alert('Error: ' + xhr.responseJSON.message);
					console.error(error);
				}
			});
		});
	</script>

	</script>

</body>


</html>